<!doctype html>
<html>
<head>
	<meta charset="utf-8">

	<title>JavaScript＋HTML5 API でできること2017</title>

	<meta name="description" content="2017.05.20 【NDSiN#12×Niigata.js×C4N】JavaScript 2017春">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
	<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/white.css" id="theme">
	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/zenburn.css">
	<link rel="stylesheet" href="css/original.css">
	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section id="p1" class="pageBlock pageBlock-first">
					<div class="midBlock">
						<h1 class="slideTitle" style="text-align: left;">JavaScript＋HTML5 API でできること2017</h1>
						<h4 class="mt50 slideTitle" style="text-align: left;">
							<a href="http://rawcode.net/">Yu Watanabe(@yuw27b)</a><br />2017.05.20 【NDSiN#12×Niigata.js×C4N】JavaScript 2017春
						</h4>
					</div>
				</section>

				<section id="p2" class="pageBlock">
					<h2>自己紹介</h2>
					<h4>
						<span class="p2_place">ECサイト運営<br /><small>[東京]</small></span>
						<i class="fa fa-truck fa-flip-horizontal" aria-hidden="true"></i>
						<span class="p2_place">非常勤エンジニア＋フリーランス<br /><small>[新潟]</small></span>
					</h4>
					<hr />
					<h4 class="mt20">最近のお仕事</h4>
					<div style="text-align: left;">
						<h5 class="mt10">SPA＋API＋DBなWebサービスの制作</h5>
						<ul class="mt10">
							<li>JavaScript[Backbone.js/React.js/Node.js]</li>
							<li>Ruby、PHP</li>
							<li>MySQL、Neo4j、RDF</li>
						</ul>
						<div class="mt20">
							<h5>その他</h5>
							<p>サービスのサーバ設定・管理</p>
							<p>HTML＋CSS＋JavaScriptのコーディング</p>
						</div>
					</div>
					<p style="text-align: right;"><small>・・・などをやっています。</small></p>
				</section>

				<section id="p3" class="pageBlock">
					<h2>APIって・・・？</h2>
					<h3 class="mt30">Application Programing Interface</h3>
					<p>ソフトウェアコンポーネントが互いにやりとりするのに使用するインタフェースの仕様</p>
					<p style="text-align: right;">
						<small><a href="https://ja.wikipedia.org/wiki/アプリケーションプログラミングインタフェース" target="_blank">https://ja.wikipedia.org/wiki/アプリケーションプログラミングインタフェース</a></small>
					</p>
					<div class="mt30">
						<i class="fa fa-arrow-circle-down" aria-hidden="true"></i>
					</div>
					<div class="mt30">
						<strong>JavaScript</strong>と、JavaScriptを実行する<strong>ブラウザ</strong>がやりとりするための仕様
					</div>
					<img class="mt30 imgNoShadow" src="./images/img02.png" width="400" height="200" alt="" />
				</section>

				<section id="p4" class="pageBlock">
					<h2>具体的にどんなもの？</h2>
					<ul class="mt50" style="text-align: left;">
						<li>DOM APIとかXMLHttpRequestとか</li>
						<li>
							APIごとに標準化が進められてはいるが、ブラウザによって実装状況に差がある<br />
							<small>例えばjQueryは、ブラウザごとのDOM APIの実装の差異を吸収してくれていた</small>
						</li>
					</ul>
					<img class="mt30 imgNoShadow" src="./images/img03.png" width="600" height="300" alt="" />
				</section>

				<section id="p5" class="pageBlock">
					<h2>HTML5 APIって・・・？</h2>
					<div class="mt50">
						<p class="mt30">「HTML5」は2014年10月に勧告されたHTMLの仕様</p>
						<p class="mt30">
							「広義のHTML5」として周辺仕様も含めたものを指すことも多い<br /><small>←今回取り上げるのはココ</small>
						</p>
						<p class="mt30">つまりHTMLとCSS以外の、ここ3年くらいで使えるようになってきた機能</p>
						<p class="mt30">主にJavaScriptで操作する</p>
					</div>
					<p style="text-align: right;">
						<small><a href="https://ja.wikipedia.org/wiki/HTML5" target="_blank">https://ja.wikipedia.org/wiki/HTML5</a></small>
					</p>
				</section>

				<section id="p6" class="pageBlock">
					<h2>どんなことができるの？</h2>
					<ul>
						<li>オフラインとストレージ - App Cache、Web Storage、Indexed Database API、File API</li>
						<li>デバイスアクセス - Geolocation API、マイク・カメラ、アドレス帳・カレンダー、端末の向き</li>
						<li>接続性 - WebSocket、Server-Sent Events</li>
						<li>マルチメディア - audio要素, video要素</li>
						<li>3D、グラフィックス、エフェクト - SVG、canvas要素、WebGL</li>
						<li>パフォーマンスと統合 - Web Workers、XMLHttpRequest Level 2</li>
					</ul>
					<p style="text-align: right;">
						<small><a href="https://ja.wikipedia.org/wiki/HTML5" target="_blank">https://ja.wikipedia.org/wiki/HTML5</a></small>
					</p>
				</section>

				<section id="p7" class="pageBlock">
					<div class="midBlock">
						<h2>ということで、<br />このへんのAPIでできることと<br />ブラウザの対応状況などを追ってみます。</h2>
						<p class="mt30">大昔からあるもの、深い考察などは取り上げません。</p>
					</div>
				</section>

				<section id="p8" class="pageBlock">
					<p style="text-align: left;">その前に<strong>ちょっと寄り道・・・</strong></p>
					<h2 class="mt50">PWA[Progressive Web Apps]のこと</h2>
					<ul class="mt30">
						<li>Googleが2015年に提唱</li>
						<li>ネイティブアプリに近いUXを提供するWebサイト</li>
						<li>オフラインでも動くとか、通知が来るとか、写真撮れるとか</li>
						<li>実現にはHTML5 APIが不可欠</li>
						<li>Apple(iPhone)のスタンスは・・・？</li>
					</ul>
				</section>
				<section id="p9" class="pageBlock">
					<h2>DOM・CSS関係</h2>
					<ul class="mt30">
						<li>
							ドラッグ＆ドロップのAPIが標準化<small>（jQuery UI がなくても大丈夫！）</small><br />
							<a href="https://html.spec.whatwg.org/multipage/interaction.html#dnd" target="_blank">Drag and drop API</a>
						</li>
						</p>
						<li>
							タブレット、スマートフォンのタッチイベントが扱えるように<br />
							<a href="https://www.w3.org/TR/touch-events/" target="_blank">Touch Events</a><br />
							<a href="https://w3c.github.io/touch-events/" target="_blank">Touch Events - Level 2</a><small>・・・こちらはまだ草案</small>
						</li>
						<li>
							マウスイベントとタッチイベントをまとめて扱えるように<br />
							<a href="https://www.w3.org/TR/pointerevents/" target="_blank">Pointer Events</a><br />
							<a href="https://w3c.github.io/pointerevents/" target="_blank">Pointer Events - Level 2</a><small>・・・こちらもまだ草案</small>
						</li>
						<li>
							CSSアニメーションのイベント取得<br />
							<a href="https://www.w3.org/TR/css3-conditional/">CSS Conditional Rules Module Level 3</a><br />
							→将来的には<a href="https://w3c.github.io/web-animations/" target="_blank">Web Animations API</a>に統合される？<br />
<pre><code>
$('.element').bind('mozTransitionEnd webkitTransitionEnd transitionend', function(){
  console.log('Transition end!');
});
$('.element').on('webkitAnimationEnd animationEnd', function(){
  console.log('Keyframe animation end!');
});
</code></pre>
						</p>
					</ul>
				</section>
				<section id="p10" class="pageBlock">
					<h2>ファイル</h2>
					<ul class="mt30">
						<li>
							<a href="https://www.w3.org/TR/FileAPI/" target="_blank">File API</a><br />
							ローカルファイルにアクセスできるようになった<small>（Flashがなくてもアップロードできる！）</small><br />
							読み取り専用、パスは取れない。<br />
							<img src="./images/img01.png" width="461" height="118" alt="" />
						</li>
						<li>
							<a href="https://wicg.github.io/entries-api/" target="_blank">File and Directory Entries API</a><br />
							ディレクトリ（フォルダ）のドロップは基本的にはまだ扱えない。（Chromeだけならがんばればできる。）
						</li>
					</ul>
				</section>
				<section id="p11" class="pageBlock">
					<h2>音を鳴らす</h2>
					<ul class="mt30">
						<li>
							<a href="https://www.w3.org/TR/webaudio/" target="_blank">Web Audio API</a><br />
							HTMLのaudio要素を扱う（play/stopなど）<br />
							だけじゃなくて、ものすごくいろいろできる。<br />
<pre><code>
var ctx = new AudioContext();

var osc = ctx.createOscillator();
osc.frequency.value = 440;
osc.type = 'sine';

var gain = ctx.createGain();
gain.gain.value = 0.5;
osc.connect(gain);
gain.connect(ctx.destination);

osc.start(ctx.currentTime);
osc.stop(ctx.currentTime + 5);
</code></pre>
						</li>
						<li>
							<a href="https://www.w3.org/TR/webmidi/" target="_blank">Web MIDI API</a><br />
							MIDIデバイスを扱う
						</li>
						<li>
							<a href="https://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html" target="_blank">Web Speech API</a><br />
							音読してもらう
						</li>
					</ul>
				</section>
				<section id="p12" class="pageBlock">
					<h2>ビデオ関係</h2>
					<ul class="mt30">
						<li>
							HTMLのvideo要素を扱う（play/stopなど）<br />
							<a href="https://developer.mozilla.org/ja/docs/Web/API/HTMLMediaElement" target="_blank">HTMLMediaElement</a><br />
							<small>「Web Video API」というものは存在しない</small>
							<p>
								再生可能なビデオ形式はブラウザによって異なるので、扱いにくい面がある。<br />
								参考：<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Supported_media_formats" target="_blank">HTML5 の audio 要素と video 要素でサポートされているメディアフォーマット</a>
							</p>
						</li>
						<li>
							ビデオの字幕（track要素）を扱う<br />
							<a href="https://www.w3.org/TR/webvtt1/" target="_blank">WebVTT: The Web Video Text Tracks Format</a><br />
						</li>
					</ul>
				</section>
				<section id="p13" class="pageBlock">
					<h2>2D・3Dグラフィック</h2>
					<div class="mt30" style="text-align: left;">
						<h3>SVG</h3>
						<p>
							<a href="https://www.w3.org/TR/SVG11/" target="_blank">SVG1.1</a> / <a href="https://www.w3.org/TR/SVG2/" target="_blank">SVG2</a><br />
							HTML DOMと同様にSVG DOMをJavaScriptから操作できるようになった。IE9以降。
						</p>
						<h3>Canvas</h3>
						<p>
							<a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API" target="_blank">Canvas API</a><br />
							JavaScriptで絵が描けるようになった
						</p>
						<h3>WebGL</h3>
						<p>
							<a href="https://www.khronos.org/registry/webgl/specs/latest/1.0/" target="_blank">WebGL</a> / <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/" target="_blank">WebGL 2</a><br />
							ブラウザでOpenGLライクな3Dグラフィックの描画。グラフィックボードで演算する。<br />
							非常に煩雑なJavaScriptコードを記述する必要があるため、ラッパーライブラリの<a href="https://threejs.org/" target="_blank">three.js</a>が使われることが多い。
						</p>
						<h3>WebVR</h3>
						<p>
							<a href="https://w3c.github.io/webvr/spec/latest/" target="_blank">WebVR</a><br />
							VRデバイスとの接続についての仕様。デバイスからセンサーの値を取得するなど。
						</p>
					</ul>
				</section>
				<section id="p14" class="pageBlock">
					<h2>デバイスにアクセスする</h2>
					<ul class="mt30">
						<li>
							<a href="https://www.w3.org/TR/geolocation-API/" target="_blank">Geolocation API</a>
						</li>
						<li>
							<a href="https://www.w3.org/TR/clipboard-apis/" target="_blank">Clipboard API and events</a>
						</li>
						<li>
							<a href="https://www.w3.org/TR/mediacapture-streams/" target="_blank">Media Capture and Streams</a>
						</li>
						<li>
							<a href="https://www.w3.org/TR/ambient-light/" target="_blank">Ambient Light Sensor</a><small>・・・Firefoxのみ。</small>
						</li>
						<li>
							<a href="https://www.w3.org/TR/battery-status/" target="_blank">Battery Status API</a>
						</li>
						<li>
							<a href="https://www.w3.org/TR/orientation-event/" target="_blank">DeviceOrientation Event Specification</a>
						</li>
						<li>
							<a href="https://webbluetoothcg.github.io/web-bluetooth/" target="_blank">Web Bluetooth</a>
						</li>
						<li>
							<a href="https://www.w3.org/TR/gamepad/" target="_blank">Gamepad</a>
						</li>
					</ul>
					<p class="mt30" style="text-align: left;">
						※ネイティブアプリでやる場合はOS提供のAPIを使うので、あくまでもWebブラウザからデバイスへのアクセスです。
					</p>
				</section>
				<section id="p15" class="pageBlock">
					<h2>サーバリクエスト</h2>
					<ul class="mt30">
						<li>
							<a href="https://www.w3.org/TR/XMLHttpRequest2/" target="_blank">XMLHttpRequest Level 2</a><br />
							おなじみのAjaxです。Level2からCORSがサポートされました。
						</li>
						<li>
							<a href="https://fetch.spec.whatwg.org/" target="_blank">Fetch API</a><br />
							XHRより低レベルのAPI。現状、Chrome・Firefoxのみ。<br />
							後述のWebWorkersからも使える。
<pre><code>
fetch(url).then(function(response) {
  return response.text();
}).then(function(text) {
  console.log(text);
});
</code></pre>
							Promiseが返ってきます。
						</li>
					</ul>
				</section>
				<section id="p16" class="pageBlock">
					<h2>Web Worker</h2>
					<div class="mt30" style="text-align:left;">
						<h3><a href="https://w3c.github.io/workers/" target="_blank">Web Workers API</a></h3>
						従来のwindowコンテキストとは別のスレッドでJavaScriptを動かせる。<br />
						重たい演算処理を別スレッドで行う、など。<br />
						このベーシックな機能はすべてのモダンブラウザに実装済み。
					</div>
					<div class="mt30" style="text-align:left;">
						<h3><a href="https://developer.mozilla.org/ja/docs/Web/API/ServiceWorker_API" target="_blank">ServiceWorker</a></h3>
						Web Workerのひとつで、ブラウザとネットワークの間のプロキシサーバーとして機能する。<br />
						PWAには欠かせないが、Chrome、Firefoxでしか動かない（モバイルも同様）。
						<ul class="mt20">
							<li>ページのキャッシュを返す（ServiceWorkerの仕様にCache APIが含まれている）</li>
							<li>オンラインになったらデータを同期する</li>
							<li>通知を出す</li>
						</ul>
						<p>Androidの場合はChromeブラウザを起動していなくてもプロセスは生きている</p>
					</div>
				</section>
				<section id="p16-2">
					<h2>Web Worker</h2>
					<div class="mt30" style="text-align:left;">
						<h3><a href="https://developer.mozilla.org/ja/docs/Web/API/ServiceWorker_API" target="_blank">ServiceWorker</a></h3>
					</div>
					<img class="imgNoShadow" src="./images/img04.png" width="800" height="400" alt="" />
				</section>
				<section id="p17" class="pageBlock">
					<h2>ストレージ</h2>
					<div class="mt30" style="text-align: left;">
						<h3>
							<a href="https://www.w3.org/TR/webstorage/" target="_blank">Web Storage</a>
						</h3>
						<p>
							Cookieより容量の大きなキーバリューストア。保存できるのは文字列。<br />
							<strong>sessionStorage</strong>と<strong>localStorage</strong>がある。<br />
							すべてのブラウザで実装済み。<br />
							プライベートブラウジングでは保存できなかったり、ユーザーがクリアしようと思えばできる点に注意。
						</p>
					</div>
					<div class="mt30" style="text-align: left;">
						<h3><a href="https://developer.mozilla.org/ja/docs/Web/API/IndexedDB_API" target="_blank">IndexedDB</a></h3>
						<p>
							<a href="https://www.w3.org/TR/IndexedDB/" target="_blank">Indexed Database API</a><br />
							<a href="https://www.w3.org/TR/IndexedDB-2/" target="_blank">Indexed Database API 2.0</a><br />
							Web Storageより「データベース」っぽいストレージ。基本的な機能は全ブラウザで使用できる。<br />
							キーバリューストアだが、テーブル（的なもの）やトランザクション、インデックスの概念がある。<br />
							WebWorkersから利用できるストレージはIndexedDBのみ。
						</p>
					</div>
				</section>
				<section id="p18" class="pageBlock">
					<h2>WebRTC</h2>
					<div class="mt30" style="text-align: left;">
						<a href="https://www.w3.org/TR/webrtc/" target="_blank">WebRTC 1.0: Real-time Communication Between Browsers</a><br />
						<a href="https://www.w3.org/TR/mediacapture-streams/" target="_blank">Media Capture and Streams</a><br />
						<a href="https://www.w3.org/TR/mediacapture-fromelement/" target="_blank">Media Capture from DOM Elements</a>
						<p>
							P2Pでブラウザ間の通信を行うための仕様。例えばビデオチャット。<br />
							Chrome、Firefoxで実装済み。<br />
							UDPを使う。<br />
							接続の確立にはサーバが必要だったり、<a href="https://www.w3.org/TR/websockets/" target="_blank">The WebSocket API</a>の併用がデファクトだったり、実装はけっこう大変そう。
						</p>
						<p class="mt20">
							<small>
								※WebRTCを利用した有名なビデオチャットサービスに<a href="https://appear.in/" target="_blank">appear.in</a>がありますが、対応ブラウザは「Chrome, Firefox, Opera and Vivaldi.」となっています。<br />
								モバイルの場合は、アプリか、AndroidではChrome, Firefox, Operaとあります。
							</small>
						</p>
					</div>
				</section>
				<section id="p19" class="pageBlock">
					<h2>そのほか</h2>
					<ul class="mt30">
						<li>
							<a href="https://www.w3.org/TR/html5/browsers.html#history" target="_blank">History API</a><br />
							<small>HTML5の仕様に含まれている</small><br />
							<a href="https://majido.github.io/scroll-restoration-proposal/history-based-api.html" target="_blank">Custom Scroll Restoration</a>はIE、Edgeで未実装。
						</li>
						<li>
							<a href="https://www.w3.org/TR/credential-management-1/" target="_blank">Credential Management Level 1</a><br />
							Chromeだけが対応中。ブラウザに保存されたID・パスワードの情報にアクセスできる。（もちろん生パスワードが見られるわけではない。）
						</li>
						<li>
							<a href="https://www.w3.org/TR/WebCryptoAPI/" target="_blank">Web Cryptography API</a><br />
							JavaScriptでハッシュ(SHA-1、SHA-2)とか公開鍵の生成ができる。ブラウザ実装はまだ足並みが揃っていない感じ。
						</li>
						<li>
							<a href="https://www.w3.org/TR/permissions/" target="_blank">The Permissions API</a><br />
							GPSとかプッシュ通知とかが使えるかどうかを判定してくれる。Chrome・Firefoxのみ。
						</li>
						<li>
							<a href="https://www.w3.org/TR/payment-request/" target="_blank">Payment Request API</a><br />
							AndroidのChromeのみで動いている・・・。仕様自体は草案段階。<br />
							Credential Management APIと同様で、ブラウザに保存されたクレジットカード情報にアクセスできる。
						</li>
					</p>
				</section>
				<section id="p20" class="pageBlock">
					<h2>おまけ：標準化から外れたもの</h2>
					<ul class="mt30">
						<li>
							ローカルにファイルを保存するようなやつ<br />
							<a href="https://www.w3.org/TR/file-writer-api/" target="_blank">File Writer API</a><br />
							<a href="https://www.w3.org/TR/file-system-api/" target="_blank">File System API</a>
						</li>
						<li>
							アドレス帳とカレンダーへのアクセス<br />
							<a href="https://www.w3.org/TR/contacts-manager-api/" target="_blank">Contacts Manager API</a><br />
							<a href="https://www.w3.org/TR/calendar-api/" target="_blank">Calendar API</a>
						</li>
					</ul>
				</section>
				<section id="p21" class="pageBlock">
					<div class="midBlock">
						<h1 class="sectionTitle">END</h1>
					</div>
				</section>
			</div><!--/.slides-->
		</div><!--/.reveal-->

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,
				controls: true,
				progress: false,
				slideNumber: true,
				overview: false,
				center: false,
				touch: true,
				transitionSpeed: 'fast',
				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
